{"title": "Identify Gaps of Records in Date Range", "tags": ["sql-server", "tsql", "gaps-and-islands"], "creation_date": 1477585645, "score": 1, "body": "<p>More general answer. I don't know what do you want to do with weeks, months etc.</p>\n\n<pre><code>select      *\n\nfrom       (SELECT        TR.TourID, TR.TourRunTimeStamp, TC.tourName, TC.tourFrequency, TC.Unit, TC.Division\n                         ,count(*) OVER (PARTITION BY TR.TourID) AS cnt\n            FROM            dbo.tblTourRun AS TR INNER JOIN\n                                     dbo.TSO_PIML_Tour_Config AS TC ON TC.tourID = TR.TourID\n            WHERE           TR.TourRunTimeStamp  BETWEEN DATEADD(day, DATEDIFF(day, 0, GETDATE()) - 1, 0) AND DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0))\n            ) t\n\nwhere       cnt &lt;&gt; case TC.tourFrequency when '1xDay' then 1 when '2xDay' then 2 when '4xDay' then 4 end\n;\n</code></pre>\n\n<hr>\n\n<pre><code>select      *\n\nfrom       (SELECT        TR.TourID, TR.TourRunTimeStamp, TC.tourName, TC.tourFrequency, TC.Unit, TC.Division, count(*) OVER (PARTITION BY TR.TourID) AS cnt\n            FROM            dbo.tblTourRun AS TR INNER JOIN\n                                     dbo.TSO_PIML_Tour_Config AS TC ON TC.tourID = TR.TourID\n            WHERE        (TC.tourFrequency = '2xDay') AND (TR.TourRunTimeStamp  BETWEEN DATEADD(day, DATEDIFF(day, 0, GETDATE()) - 1, 0) AND DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0))\n            ) t\n\nwhere       cnt = 1\n;\n</code></pre>\n", "last_activity_date": 1477586006, "answer_id": 40289811, "is_accepted": true, "owner": {"user_id": 6336479, "reputation": 1313, "user_type": "registered", "accept_rate": 43, "display_name": "Dudu Markovitz", "link": "http://stackoverflow.com/users/6336479/dudu-markovitz", "profile_image": "https://lh4.googleusercontent.com/-7ttJnI3nmS4/AAAAAAAAAAI/AAAAAAAAJnE/jcRD1UDdrzE/photo.jpg?sz=128"}, "last_edit_date": 1477586006, "question_id": 40288634}