{"body": "<p>Here's a solution if you only need to search the contents PDFs, MSWord, and Excel. There's a different procedure for each. A caveat is that you need to have a version of Adobe that you pay for. This won't work on plain Adobe Reader. I've tested it a few times and it works, but it seems kind of chunky in some parts so I'm open to suggestions.</p>\n\n<pre><code>            Sub attachsearch()\n            Dim ns As Namespace\n            Dim inbox As MAPIFolder\n            Dim subfolder As MAPIFolder\n            Dim item As Object\n            Dim atmt As Attachment\n            Dim tempfilepath As String\n            Dim tempfilename As String\n            Dim i As Integer\n            Dim workbk As Workbook\n            Dim LastRow As Long\n            Dim TextToFind  As String\n            Dim Loc As Range\n            Dim Sh As Worksheet\n            Dim WS_Count As Integer\n            Dim x As Integer\n            Dim WS_Name As String\n\n            Set ns = GetNamespace(\"MAPI\")\n            Set inbox = ns.GetDefaultFolder(olFolderInbox)\n            Set subfolder = inbox.Folders(\"test\")\n            Set workbk = Workbooks.Open(\"C:\\Users\\John.Doe\\Desktop\\10 25 2016 Pricing Team Macro.xlsx\")\n            LastRow = Workbooks(\"10 25 2016 Pricing Team Macro\").Worksheets(\"NDC Sort\").Cells(Worksheets(\"NDC Sort\").Rows.Count, \"A\").End(xlUp).Row\n            i = 0\n            If subfolder.Items.Count = 0 Then\n            MsgBox \"There are no emails to look at. Please stop wasting my time.\", vbInformation, \"Folder is Empty\"\n            Exit Sub\n            End If\n\n            For Each item In subfolder.Items\n            For Each atmt In item.Attachments\n            If item.FlagStatus = Empty Then\n                If Right(atmt.Filename, 4) Like \"xl**\" Or Right(atmt.Filename, 3) Like \"xl*\" Then\n                    tempfilepath = \"O:\\aaaTEST\\\"\n                    tempfilename = Format(item.ReceivedTime, \"yyyymmdd_hhnnss_\") &amp; item.SenderName &amp; \"_\" &amp; atmt.Filename\n                    atmt.SaveAsFile tempfilepath &amp; tempfilename\n                    Workbooks.Open (tempfilepath &amp; tempfilename)\n                    Workbooks(tempfilename).Activate\n                    WS_Count = Workbooks(tempfilename).Worksheets.Count\n                    'Clearing any selections that may limit the search unintentionally\n                    For x = 1 To WS_Count\n                    With ActiveWorkbook.Worksheets(x)\n                    .Select\n                    .Cells(1, 1).Select\n                    Application.CutCopyMode = False\n                    End With\n                    Next x\n                For rwindex = 2 To LastRow\n                    If item.FlagStatus = Empty Then\n                    TextToFind = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n                        If TextToFind &lt;&gt; \"\" Then\n                            Workbooks(tempfilename).Activate\n                            For x = 1 To WS_Count\n                            With ActiveWorkbook.Worksheets(x)\n                                    .Select\n                                    .UsedRange.Select\n                                   Set Loc = .Cells.Find(TextToFind)\n                            If item.FlagStatus = Empty Then\n                                If Not Loc Is Nothing Then\n                                 i = i + 1\n                                 With item\n                                .FlagRequest = \"Follow up\"\n                                .Save\n                                End With\n                                End If\n                            End If\n                            Set Loc = Nothing\n                            End With\n                            Next x\n                        End If\n                     End If\n                     Next rwindex\n                     Workbooks(tempfilename).Close Savechanges:=False\n                End If\n\n            'PDF Check\n                If Right(atmt.Filename, 3) = \"pdf\" Then\n                    tempfilename = \"O:\\aaaTEST\\\" &amp; _\n                    Format(item.ReceivedTime, \"yyyymmdd_hhnnss_\") &amp; item.SenderName &amp; \"_\" &amp; atmt.Filename\n                    atmt.SaveAsFile tempfilename\n                    PDFPath = tempfilename\n\n                Set App = CreateObject(\"AcroExch.App\", \"\")\n\n                Set AVDoc = CreateObject(\"AcroExch.AVDoc\")\n\n                        If AVDoc.Open(PDFPath, \"\") = True Then\n                          AVDoc.BringToFront\n                          For rwindex = 2 To 3593\n                            If item.FlagStatus = Empty Then\n                            TextToFind = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n                                If AVDoc.FindText(TextToFind, False, True, False) = True Then\n                                i = i + 1\n                                With item\n                                .FlagRequest = \"Follow up\"\n                                .Save\n                                End With\n                                End If\n                            AVDoc.Close True\n                            App.Exit\n                            End If\n                        Next rwindex\n                        End If\n                End If\n\n                'MSWord check\n                If Right(atmt.Filename, 4) Like \"doc*\" Or Right(atmt.Filename, 3) Like \"doc\" Then\n                    tempfilepath = \"O:\\aaaTEST\\\"\n                    tempfilename = Format(item.ReceivedTime, \"yyyymmdd_hhnnss_\") &amp; item.SenderName &amp; \"_\" &amp; atmt.Filename\n                    atmt.SaveAsFile tempfilepath &amp; tempfilename\n                    Set wordapp = CreateObject(\"word.Application\")\n                    wordapp.Documents.Open Filename:=tempfilepath &amp; tempfilename\n                    wordapp.Visible = True\n                    For rwindex = 2 To 5\n                        If item.FlagStatus = Empty Then\n                        TextToFind = Workbooks(\"10 25 2016 Pricing Team Macro\").Sheets(\"NDC Sort\").Cells(rwindex, 1).Value\n                            If TextToFind &lt;&gt; \"\" Then\n                                With wordapp.ActiveDocument.Content.Find\n                                .ClearFormatting\n                                .Execute FindText:=TextToFind\n                                If .Found = True Then\n                                    i = i + 1\n                                    With item\n                                        .FlagRequest = \"Follow up\"\n                                        .Save\n                                    End With\n                                End If\n                                End With\n                            End If\n                        End If\n                    Next rwindex\n                wordapp.ActiveDocument.Close Savechanges:=wdDoNotSaveChanges\n                wordapp.Quit Savechanges:=wdDoNotSaveChanges\n                End If\n            End If\n            Next atmt\n            Next item\n            Workbooks(\"10 25 2016 Pricing Team Macro\").Close Savechanges:=False\n\n            If i &gt; 0 Then\n            MsgBox \"I found \" &amp; i &amp; \" attached files with a specific name.\"\n            Else\n            MsgBox \"I didn't find any files\"\n            End If\n            Set atmt = Nothing\n            Set item = Nothing\n            Set ns = Nothing\n            Exit Sub\n\n            End Sub\n</code></pre>\n", "tags": ["excel", "vba", "excel-vba", "email", "outlook"], "creation_date": 1477688555, "score": 0, "last_activity_date": 1477688555, "answer_id": 40313174, "is_accepted": true, "owner": {"user_id": 7066428, "reputation": 1, "user_type": "registered", "display_name": "ehenryindy", "link": "http://stackoverflow.com/users/7066428/ehenryindy", "profile_image": "https://www.gravatar.com/avatar/03874d4528996443aa4d87d3b1b40d40?s=128&d=identicon&r=PG&f=1"}, "title": "Excel VBA for searching String within an Outlook Attachment, flagging email if match is found", "question_id": 40267587}