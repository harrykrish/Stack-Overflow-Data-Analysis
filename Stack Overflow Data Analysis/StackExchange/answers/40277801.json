{"title": "I wrote a JavaScript to move a cat on canvas: &quot;\u0e05(*\u03a6\u03c9\u03a6*) \u0e05&quot; But the cat jumps weirdly", "tags": ["javascript", "html", "canvas"], "creation_date": 1477550323, "score": 2, "body": "<p>1) I replaced only all let to var (everything is working good):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var surface=document.getElementById(\"drawingArea\");\r\nvar ctx=surface.getContext(\"2d\");\r\nvar cor_x;\r\nvar cor_y;\r\n\r\n\r\n\r\n/** draw a cat \r\n\t*\tinput the coordinates x and y for the center of the cat\r\n\t*\tdoes not return, output the drawing only.\r\n\t*/\r\nvar drawCat = function (x, y) {\r\n\r\n\t\tctx.save();\r\n\t\tctx.translate(x, y);\r\n\t\tctx.fillText(\"\u0e05(*\u03a6\u03c9\u03a6*) \u0e05\", -20,-5);\r\n\t\tctx.restore();\r\n\r\n\t\t};\r\n\r\nvar updateCoordinate = function(x_increment,y_increment){\r\n        console.log(\"before:\" + cor_x + \"/\" + cor_y);\r\n        cor_x += 10 * x_increment;\r\n        cor_y += 10 * y_increment;\r\n        console.log(\"updated:\" + cor_x + \"/\" + cor_y);\r\n};\r\n\r\nvar moveUp = function (){\r\n    updateCoordinate(0,-1);\r\n    console.log(cor_x + \"/\" + cor_y );\r\n    ctx.clearRect(0,0,surface.width,surface.height);\r\n    drawCat(cor_x,cor_y);\r\n};\r\n\r\n\r\nvar moveLeft = function (){\r\n    updateCoordinate(-1,0);\r\n    console.log( cor_x + \"/\" + cor_y );\r\n    ctx.clearRect(0,0,surface.width,surface.height);\r\n    drawCat(cor_x,cor_y);  \r\n};\r\n\r\nvar moveRight = function (){\r\n    updateCoordinate(1,0);\r\n    console.log( cor_x + \"/\" + cor_y );\r\n    ctx.clearRect(0,0,surface.width,surface.height);\r\n    drawCat(cor_x,cor_y);   \r\n};\r\n\r\nvar moveDown = function (){\r\n    updateCoordinate(0,1);\r\n    console.log(cor_x + \"/\" + cor_y );\r\n    ctx.clearRect(0,0,surface.width,surface.height);\r\n    drawCat(cor_x,cor_y);  \r\n};\r\n\r\nvar reset =  function(){\r\n\t\tcor_x=surface.width/2.0;\r\n\t\tcor_y=surface.height/2.0;\r\n    console.log(cor_x + \"/\" + cor_y );\r\n    ctx.clearRect(0,0,surface.width,surface.height);\r\n    drawCat(cor_x,cor_y); \r\n}\r\n\r\ndrawCat(200,200);</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;body onload=\"reset();\"&gt;\r\n&lt;main&gt;\r\n\r\n&lt;!-- place your HTML code within the main --&gt;\r\n    \r\n    &lt;canvas width=\"400\" height=\"400\" id=\"drawingArea\" style=\"border:solid\"&gt;cat image&lt;/canvas&gt;\r\n    &lt;p&gt;\r\n        &lt;input type=\"button\" id=\"resetBtn\" value=\"reset\" onclick=\"reset();\" /&gt;    \r\n    &lt;/p&gt;\r\n    &lt;p&gt;\r\n        &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\r\n        &lt;input type=\"button\" id=\"upBtn\" value=\"Up\" onclick=\"moveUp();\"/&gt;    \r\n    &lt;/p&gt;\r\n    &lt;p&gt;\r\n        &lt;input type=\"button\" id=\"leftBtn\" value=\"Left\" onclick=\"moveLeft();\"/&gt; \r\n        &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\r\n        &lt;input type=\"button\" id=\"rightBtn\" value=\"Right\" onclick=\"moveRight();\"/&gt;    \r\n    &lt;/p&gt;\r\n        &lt;p&gt;\r\n        &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\r\n        &lt;input type=\"button\" id=\"downBtn\" value=\"Down\" onclick=\"moveDown();\"/&gt;    \r\n    &lt;/p&gt;\r\n&lt;/main&gt;\r\n\r\n&lt;/body&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>It is bug with let variable:</p>\n\n<p>From console log:</p>\n\n<blockquote>\n  <p>(index):96 before:160/390</p>\n  \n  <p>(index):99 updated:160/400 </p>\n  \n  <p>(index):126 160/280</p>\n</blockquote>\n\n<p>Within updateCoordinate: cor_x = 160; cor_y = 400 BUT within moveRight (or moveLeft, moveUp, moveDown) cor_x = 160; cor_y = 280 </p>\n", "last_activity_date": 1477746780, "answer_id": 40277801, "is_accepted": false, "owner": {"user_id": 5754223, "reputation": 81, "user_type": "registered", "accept_rate": 83, "display_name": "artamonovdev", "link": "http://stackoverflow.com/users/5754223/artamonovdev", "profile_image": "https://www.gravatar.com/avatar/c2b56ce0b7020002e4f57fb6c3532718?s=128&d=identicon&r=PG&f=1"}, "last_edit_date": 1477746780, "question_id": 40276198}