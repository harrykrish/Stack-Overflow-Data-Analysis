{"title": "Django: How to filter on inner join based on properties of second table?", "tags": ["django", "django-models", "django-queryset"], "creation_date": 1477668381, "score": 0, "body": "<p>Okay, I think I got it:</p>\n\n<pre><code>from django.db.models import Max, F\n\nUser.objects\\\n  .annotate(latest_status_update_id=Max('statusupdate__id'))\\\n  .filter(\n    statusupdate__id=F('latest_status_update_id'), \n    statusupdate__text__icontains='hello'\n  )\n</code></pre>\n\n<p>For more info, see <a href=\"https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships\" rel=\"nofollow\">this section of the Django documentation</a>.</p>\n\n<p><strong><em>Please note:</em></strong> I ended up changing my strategy a bit and settling for the strategy where the highest ID means the latest update. This is the case because I realized that a User could post two updates the same time and that would break my query.</p>\n", "last_activity_date": 1477723846, "answer_id": 40308349, "is_accepted": true, "owner": {"user_id": 99971, "reputation": 2957, "user_type": "registered", "accept_rate": 85, "display_name": "daveslab", "link": "http://stackoverflow.com/users/99971/daveslab", "profile_image": "https://www.gravatar.com/avatar/e14c474117597f3b8c7c6489a5ace397?s=128&d=identicon&r=PG"}, "last_edit_date": 1477723846, "question_id": 40246285}