{"title": "1st april dates of 80s failed to parse in iOS 10.0", "tags": ["ios", "swift", "nsdateformatter", "foundation"], "creation_date": 1477572468, "score": 9, "body": "<p>This problem occurs if <em>daylight saving time</em> starts exactly on\n<em>midnight</em>, as it was the case in Moscow in the years 1981\u20131984 (see for example <a href=\"http://www.timeanddate.com/time/change/russia/moscow\" rel=\"nofollow\">Clock Changes in Moscow, Russia (Moskva)</a>).</p>\n\n<p>This was also observed in</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/12922645/why-does-nsdateformatter-return-nil-date-for-these-4-time-zones\">Why does NSDateFormatter return nil date for these 4 time zones?</a> and</li>\n<li><a href=\"http://stackoverflow.com/questions/24088730/why-nsdateformatter-is-returning-null-for-a-19-10-2014-in-a-brazilian-time-zone\">Why NSDateFormatter is returning null for a 19/10/2014 in a Brazilian time zone?</a></li>\n</ul>\n\n<p>For example, at midnight of April 1st 1984, the clocks were adjusted one hour forward, which means that the date \"1984-04-01 00:00\" \ndoes not exist in that timezone:</p>\n\n<pre><code>let dFmt = DateFormatter()\ndFmt.dateFormat = \"yyyy-MM-dd\"\ndFmt.timeZone = TimeZone(identifier: \"Europe/Moscow\")\nprint(dFmt.date(from: \"1984-04-01\")) // nil\n</code></pre>\n\n<p>As a solution, you can tell the date formatter to be \"lenient\":</p>\n\n<pre><code>dFmt.isLenient = true\n</code></pre>\n\n<p>and then it will return the first valid date on that day:</p>\n\n<pre><code>dFmt.isLenient = true\nif let date = dFmt.date(from: \"1984-04-01\") {\n    dFmt.dateFormat = \"yyyy-MM-dd HH:mm:ss\"\n    print(dFmt.string(from: date)) \n}\n// 1984-04-01 01:00:00\n</code></pre>\n\n<p><a href=\"http://stackoverflow.com/a/24089663/1187415\">A different solution</a>\nwas given by rob mayoff, which is to make the date formatter use <em>noon</em> instead of midnight as the\ndefault date. Here is a translation of rob's code from Objective-C to Swift:</p>\n\n<pre><code>let noon = DateComponents(calendar: dFmt.calendar, timeZone: dFmt.timeZone,\n               year: 2001, month: 1, day: 1, hour: 12, minute: 0, second: 0)\ndFmt.defaultDate = noon.date\nif let date = dFmt.date(from: \"1984-04-01\") {\n    dFmt.dateFormat = \"yyyy-MM-dd HH:mm:ss\"\n    print(dFmt.string(from: date)) \n}\n// 1984-04-01 12:00:00\n</code></pre>\n", "last_activity_date": 1477753646, "answer_id": 40284990, "is_accepted": true, "owner": {"user_id": 1187415, "reputation": 252126, "user_type": "registered", "accept_rate": 88, "display_name": "Martin R", "link": "http://stackoverflow.com/users/1187415/martin-r", "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1"}, "last_edit_date": 1477753646, "question_id": 40284272}