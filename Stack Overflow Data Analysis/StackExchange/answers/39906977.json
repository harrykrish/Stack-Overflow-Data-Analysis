{"title": "Struts 2 calling static method when struts.ognl.allowStaticMethodAccess is false", "tags": ["java", "reflection", "struts2", "ognl", "valuestack"], "creation_date": 1475795330, "score": 1, "body": "<p>OGNL allows execution of methods, but the static access is disabled by default, so you cannot use static method in expressions. However, you can teach OGNL which classes needs to access the static methods.</p>\n\n<blockquote>\n  <h2><a href=\"https://commons.apache.org/proper/commons-ognl/developer-guide.html#Method_Accessors\" rel=\"nofollow\">OGNL developer guide: Method Accessors</a></h2>\n  \n  <p>Method calls are another area where OGNL needs to do lookups for methods based on dynamic information. The <code>MethodAccessor</code> interface provides a hook into how OGNL calls a method. When a static or instance method is requested the implementor of this interface is called to actually execute the method.</p>\n\n<pre><code>public interface MethodAccessor\n{\n\n    Object callStaticMethod( Map context, Class targetClass, String methodName, List args )\n        throws MethodFailedException;\n\n    Object callMethod( Map context, Object target, String methodName, List args )\n        throws MethodFailedException;\n\n}\n</code></pre>\n  \n  <p>You can set a method accessor on a class-by-class basis using <code>OgnlRuntime.setMethodAccessor()</code>. The is a default method accessor for Object (which simply finds an appropriate method based on method name and argument types and uses reflection to call the method).</p>\n</blockquote>\n\n<hr>\n\n<p>You can code something</p>\n\n<pre><code>public class StringUtil extends StringUtils implements MethodAccessor {\n  //implement above methods\n}  \n</code></pre>\n\n<hr>\n\n<h1>Action class</h1>\n\n<pre><code>public static final String MESSAGE = \"hello.message\";\n\n/**\n * Field for Message property.\n */\nprivate String message;\n\n/**\n * Return Message property.\n *\n * @return Message property\n */\npublic String getMessage() {\n    return message;\n}\nprivate StringUtil stringUtil = new StringUtil();\n\npublic StringUtil getStringUtil() {\n  return stringUtil;\n}\n\npublic String execute() throws Exception {\n    setMessage(getText(MESSAGE));\n    OgnlRuntime.setMethodAccessor(StringUtil.class, stringUtil);\n    return SUCCESS;\n}\n</code></pre>\n\n<hr>\n\n<h1>In JSP</h1>\n\n<pre class=\"lang-jsp prettyprint-override\"><code>&lt;s:if test=\"!stringUtil.isEmpty(message)\"&gt;\n  &lt;h2&gt;&lt;s:property value=\"message\"/&gt;&lt;/h2&gt;\n&lt;/s:if&gt;\n</code></pre>\n\n<hr>\n", "last_activity_date": 1475795659, "answer_id": 39906977, "is_accepted": true, "owner": {"user_id": 573032, "reputation": 34515, "user_type": "registered", "accept_rate": 91, "display_name": "Roman C", "link": "http://stackoverflow.com/users/573032/roman-c", "profile_image": "https://www.gravatar.com/avatar/bca617231294691f95f0e9f0ee623630?s=128&d=identicon&r=PG"}, "last_edit_date": 1475795659, "question_id": 39875242}