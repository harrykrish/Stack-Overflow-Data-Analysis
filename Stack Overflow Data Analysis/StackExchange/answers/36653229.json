{"title": "join two rdds to make an adjacency list", "tags": ["python", "apache-spark", "pyspark", "rdd"], "creation_date": 1460740720, "score": 1, "body": "<p>So if I am understanding correctly you wish to have an adjacency list where the final RDD consists of key-values pairs with the key being the node and the value a list of it's edges. Perhaps something as shown below is what you had in mind? Though I believe if you want 'g' to be shown in your final RDD it would make sense to have it in your edges list as ('g', '') since you wish to convey that it has no edges.</p>\n\n<p>To join we need to convert the nodes list to a pair RDD, so first we parallelize to create the RDD and then map a dummy value so that we have key-value pairs.</p>\n\n<p>Now we can join the two RDDs to each other and the result will be only the keys that exist in both RDDs in this case 'a' and 'f'. Finally we strip the dummy value we added to the the nodes RDD and groupByKey to group our values together.</p>\n\n<pre><code>nodes = ['a', 'b', 'c', 'd', 'e', 'f', 'g']\nedges = [('a','b'), ('a','e'), ('f', 'a'), ('k','l')]\nnodesRDD = sc.parallelize(nodes).map(lambda n: (n, ''))\nedgesRDD = sc.parallelize(edges)\njoinedRDD = nodesRDD.join(edgesRDD).map(lambda tup: (tup[0], tup[1][1]))\ngroupedRDD = joinedRDD.groupByKey()\n\ngroupedRDD.map(lambda x : (x[0], list(x[1]))).collect()\n</code></pre>\n\n<p>Out[146]: [('f', ['a']), ('a', ['b', 'e'])]</p>\n\n<p>Count is similar but now we do not care about the actually node values, only their counts:</p>\n\n<pre><code>nodes = ['a', 'b', 'c', 'd', 'e', 'f', 'g']\nedges = [('a','b'), ('a','e'), ('f', 'a'), ('k','l')]\nnodesRDD = sc.parallelize(nodes).map(lambda n: (n, 0))\nedgesRDD = sc.parallelize(edges).map(lambda tup: (tup[0], 1))\njoinedRDD = nodesRDD.join(edgesRDD).map(lambda tup: (tup[0], tup[1][1]))\nreducedRDD = joinedRDD.reduceByKey(lambda a, b: a + b)\n\nreducedRDD.collect()\n</code></pre>\n\n<p>Out[159]: [('f', 1), ('a', 2)]</p>\n", "last_activity_date": 1460742935, "answer_id": 36653229, "is_accepted": true, "owner": {"user_id": 2487157, "reputation": 93, "user_type": "registered", "display_name": "esap120", "link": "http://stackoverflow.com/users/2487157/esap120", "profile_image": "https://www.gravatar.com/avatar/e358812b92da10d80b2f35e6c24167c6?s=128&d=identicon&r=PG"}, "last_edit_date": 1460742935, "question_id": 36650083}