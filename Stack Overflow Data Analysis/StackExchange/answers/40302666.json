{"body": "<p>Using <code>UNION</code> to bring the light and medium desktops tables together as a single dataset shouldn't give you duplicates unless the tables contain duplicate values in rows accross <strong>all columns</strong> in your <code>SELECT</code> clauses and you use <code>UNION ALL</code>. <em>If you know your tables have unique values use <code>UNION ALL</code> to give a performance boost.</em></p>\n\n<p>I would combine the two tables in a common table expression (cte) and then join the resultant table with a <code>LEFT OUTER JOIN</code> to your user table which can also be filtered to find entries where there is no match <code>WHERE [user].[UserID] IS NULL</code>, NB, that would return orphaned rows in your desktops tables where the user has been deleted; alternatively drop the left outer join and use <code>WHERE [desktop].[UserID] IS NULL</code> to return only dekstops without assiged users.</p>\n\n<p>You could try the following code;</p>\n\n<pre><code>WITH cte_Desktop AS\n(\n    SELECT\n        [ID] as [DesktopID],\n        'Light Desktop' as [DekstopType],\n        [Model],\n        [MACAddress],\n        [UserID]\n    FROM [dbo].[LightDesktops]\n\n    UNION\n\n    SELECT\n        [ID],\n        'Medium Desktop',\n        [Model],\n        [MACAddress],\n        [UserID]\n    FROM [dbo].[MediumDesktops]\n)\n\nSELECT\n    [desktop].*\n\nFROM cte_Desktop AS [desktop]\nLEFT OUTER JOIN [dbo].[Users] AS [user]\n    on [user].[UserID] = [desktop].[UserID]\n\nWHERE [user].[UserID] IS NULL\n</code></pre>\n", "tags": ["sql-server"], "creation_date": 1477648790, "score": 2, "last_activity_date": 1477648790, "answer_id": 40302666, "is_accepted": true, "owner": {"user_id": 1849866, "reputation": 771, "user_type": "registered", "display_name": "Edward Comeau", "link": "http://stackoverflow.com/users/1849866/edward-comeau", "profile_image": "https://i.stack.imgur.com/6xUJ6.jpg?s=128&g=1"}, "title": "What kind of JOIN should I use to join these tables?", "question_id": 40301468}