{"title": "How to create a CSV file from Core Data (swift)", "tags": ["ios", "swift", "csv", "core-data"], "creation_date": 1456014378, "score": 2, "body": "<p>This is a concise way of doing all you want - you pass array of managed objects and a string that is CSV's filename. The method writes your CSV to a file. I believe you already have most of this in your code, the thing that is lacking are last two lines that just write a string into a new file in \"Documents\" directory.</p>\n\n<pre><code>func writeCoreDataObjectToCVS(objects: [NSManagedObject], named: String) -&gt; String {\n    /* We assume that all objects are of the same type */\n    guard objects.count &gt; 0 else {\n        return\n    }\n    let firstObject = objects[0]\n    let attribs = Array(firstObject.entity.attributesByName.keys)\n    let csvHeaderString = (attribs.reduce(\"\",combine: {($0 as String) + \",\" + $1 }) as NSString).substringFromIndex(1) + \"\\n\"\n\n    let csvArray = objects.map({object in\n        (attribs.map({(object.valueForKey($0) ?? \"NIL\").description}).reduce(\"\",combine: {$0 + \",\" + $1}) as NSString).substringFromIndex(1) + \"\\n\"\n    })\n    let csvString = csvArray.reduce(\"\", combine: +)\n\n    return csvHeaderString+csvString\n}\n</code></pre>\n\n<p>Now, somewhere else in the code you need to create NSData from this string and add it to mail composer:</p>\n\n<pre><code>let csvString = .....\nlet data = csvString.dataUsingEncoding(NSUTF8StringEncoding)\nlet composer = MFMailComposeViewController()\ncomposer.addAttachmentData(attachment: data,\n          mimeType mimeType: \"text/csv\",\n          fileName filename: \"mydata.csv\")\n</code></pre>\n\n<p>Then, do the usual stuff with the composer (set body, topic, etc) and present it to the user!</p>\n\n<p>EDIT:</p>\n\n<p>Edited the answer to better answer the question.</p>\n", "last_activity_date": 1456078823, "answer_id": 35530793, "is_accepted": true, "owner": {"user_id": 1186443, "reputation": 379, "user_type": "registered", "accept_rate": 50, "display_name": "Terminus", "link": "http://stackoverflow.com/users/1186443/terminus", "profile_image": "https://www.gravatar.com/avatar/dd987e119d885774a419552163c845b1?s=128&d=identicon&r=PG"}, "last_edit_date": 1456078823, "question_id": 35530506}