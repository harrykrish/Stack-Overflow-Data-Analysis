{"body": "<p>You can take reference from something like this</p>\n\n<pre><code>List&lt;DBObject&gt; pipeline=new ArrayList&lt;DBObject&gt;();\nDBObject match = new BasicDBObject(\"$match\", new BasicDBObject(\"date\", sdf.format(new Date())).append(\"country\", country).append(\"operator\", operator).append(\"server_ip\", server_ip));\nDBObject unwind = new BasicDBObject(\"$unwind\", \"$details\");\nDBObject match2 = new BasicDBObject(\"$match\", new BasicDBObject(\"details.type\", \"application_health\"));\nDBObject sort = new BasicDBObject(\"$sort\", new BasicDBObject(\"details.datetime\", -1));\nDBObject limit = new BasicDBObject(\"$limit\", 1);\npipeline.add(match);\npipeline.add(unwind);\npipeline.add(match2);\npipeline.add(sort);\npipeline.add(limit);\nAggregationOutput outputoutput = collection.aggregate(pipeline);\n</code></pre>\n", "tags": ["mongodb", "aggregation-framework", "mongodb-java", "mongo-java-driver"], "creation_date": 1477294850, "score": 0, "last_activity_date": 1477294850, "answer_id": 40213063, "is_accepted": false, "owner": {"user_id": 3956731, "reputation": 481, "user_type": "registered", "display_name": "Karan Verma", "link": "http://stackoverflow.com/users/3956731/karan-verma", "profile_image": "https://i.stack.imgur.com/nppV1.jpg?s=128&g=1"}, "title": "MongoDB deleting aggregated cells", "question_id": 40206868}