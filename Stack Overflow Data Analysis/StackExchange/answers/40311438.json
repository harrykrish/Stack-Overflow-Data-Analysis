{"body": "<p>As I mentioned in the comment, the standard solver in Excel has a maximum limit for decision variables of 200.</p>\n\n<p>This example is limited to 200 variables - if you have the premium solver, you can expand the solution. This was done using Excel 2016.</p>\n\n<p><strong>Worksheet setup</strong></p>\n\n<ol>\n<li>Column A contains the size data.</li>\n<li>Column B contains the \"Group\" that each member in Column A will belong to. It is initially populated using the formula <code>=RANDBETWEEN(1,5)</code>. It was then overridden using Copy / Paste Special - Values.</li>\n<li>Column D contains the aggregated groups, labelled 1 through 5.</li>\n<li>Column E contains the aggregated size within each group. It is calculated with <code>=SUMIF($B$2:$B$201,\"=\"&amp;D2,$A$2:$A$201)</code></li>\n<li>Column F contains the target value for each group (1000 for groups 1 through 4, ignored for group 5).</li>\n<li>Column G contains the squared error from the target value for each group. It is calculated with <code>=(E2-F2)^2</code></li>\n<li>Cell G7 will be the \"Set Objective\" cell and is the sum of error squared. It is calculated with <code>=SUM(G2:G5)</code></li>\n</ol>\n\n<p>Below is a screen shot of the setup worksheet, before using solver.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WC0D5.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/WC0D5.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Solver Setup</strong></p>\n\n<p>Solver is setup with the following criteria ...</p>\n\n<ol>\n<li>\"Set Objective:\" is <code>$G$7</code></li>\n<li>\"To:\" is \"Min\"</li>\n<li>\"By Changing Variable Cells:\" is <code>$B$2:$B$201</code></li>\n<li>\"Subject to the Constraints:\" includes: <code>$B$2:$B$201 &lt;= 5</code>, <code>$B$2:$B$201 = integer</code>, and <code>$B$2:$B$201 &gt;= 1</code></li>\n<li>\"Select a Solving Method:\" is <code>Evolutionary</code>. Note: You could use GRG, but it will be much slower.</li>\n<li>In \"Options\", on the \"All Methods\" tab, in the \"Solving with Integer Constraints\" area, make sure <code>Ignore Integer Constraints</code> is <em>not</em> checked.</li>\n</ol>\n\n<p>Below is a screen shot of the Solver Parameters dialog:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Up1bN.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/Up1bN.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Solution</strong></p>\n\n<p>Your optimal region may be \"flat\" so there are multiple possible solutions.</p>\n\n<p>Below is a screen shot of a solution I generated ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/xbpQi.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/xbpQi.png\" alt=\"enter image description here\"></a></p>\n", "tags": ["excel", "solver"], "creation_date": 1477680498, "score": 1, "last_activity_date": 1477680498, "answer_id": 40311438, "is_accepted": true, "owner": {"user_id": 2901085, "reputation": 1623, "user_type": "registered", "accept_rate": 100, "display_name": "OldUgly", "link": "http://stackoverflow.com/users/2901085/oldugly", "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1"}, "title": "how to get different cell groups each add up to a certain number", "question_id": 40196466}