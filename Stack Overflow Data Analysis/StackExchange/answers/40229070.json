{"title": "Creating a map of maps from a map Java 8", "tags": ["java", "java-8", "java-stream"], "creation_date": 1477351233, "score": 0, "body": "<p>If I understand your questions correctly I would express it as follows:</p>\n\n<p>Given:</p>\n\n<pre><code>class ClassA {\n    public String getA();\n    public ClassB getB();\n}\n\nclass ClassB {\n    public String getC();\n}\n\nMap&lt;String, List&lt;ClassA&gt;&gt; input;\n</code></pre>\n\n<p>How would I create a <code>Map&lt;String, Map&lt;String, List&lt;ClassB&gt;&gt;</code> where the key of the inner map is the result of <code>getA</code>?</p>\n\n<p>If that's correct then you aren't looking to change the keys of the outer map at all. That makes it a good candidate for <code>Map.replaceAll</code>. For clarity I've split the collector into a separate method so it's clear what's happening:</p>\n\n<pre><code>input.replaceAll(listA.stream().collect(mapCollector()));\n\nprivate Collector&lt;A, ?, Map&lt;String, List&lt;B&gt;&gt; mapCollector() {\n    return Collectors.groupingBy(ClassA::getA,\n        Collectors.mapping(ClassA::getB,\n            Collectors.toList()));\n}\n</code></pre>\n\n<p>Explaining the method it says group <code>A</code>s by <code>getA</code> as key, then collect those <code>A</code>s by mapping using <code>getB</code> then putting in a list.</p>\n\n<p>If you particularly want a new map (rather than changing the original one) then:</p>\n\n<pre><code>Map&lt;String, Map&lt;String, List&lt;ClassB&gt;&gt;&gt; output = input.entrySet().stream()\n    .collect(Collectors.toMap(Map.Entry::getKey, e -&gt; e.getValue().stream().collect(mapCollector()));\n</code></pre>\n", "last_activity_date": 1477351558, "answer_id": 40229070, "is_accepted": false, "owner": {"user_id": 3705127, "reputation": 10046, "user_type": "registered", "accept_rate": 53, "display_name": "sprinter", "link": "http://stackoverflow.com/users/3705127/sprinter", "profile_image": "https://www.gravatar.com/avatar/b03aedaddfa4dc1c2b331f318a724ec7?s=128&d=identicon&r=PG&f=1"}, "last_edit_date": 1477351558, "question_id": 40228373}