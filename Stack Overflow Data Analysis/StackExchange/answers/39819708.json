{"title": "R won&#39;t predict a continuous variable using a bayesian network (Throws Error)", "tags": ["r"], "creation_date": 1475429216, "score": 0, "body": "<p>By default, most Bayesian network algorithms assume that all the variables are binary (yes/no) consisting of ones and zeroes, and not continuous.  Thus, probably check the data requirements/options for the R-package you're using.  <a href=\"http://www.sc.ehu.es/ccwbayes/members/aritz/documentos/FlexibleClassifiers-Aritz-TechReport06.pdf\" rel=\"nofollow\">Bayesian networks which use continuous variables</a> commonly employ kernel density estimation (KDE).  You could try searching for a Bayesian network package that uses the Epanechnikov kernel, which is one of the most common kernels used for KDE.</p>\n\n<p>I looked at your R-code, and after tweaking some of the dependencies, you need to use the following code to make a prediction and obtain the accuracy:</p>\n\n<pre><code>    library(bnlearn)                       # Load the package in R\n    install.packages(\"Rcpp\") \n    install.packages(\"forecast\", dependencies = TRUE) \n    library(forecast)\n    data(gaussian.test)\n    training.set = gaussian.test[1:4000, ] # This is training set to learn the parameters\n    test.set = gaussian.test[4001:4010, ]  # This is test set to give as evidence\n    res = hc(training.set)                 # learn BN structure on training set data \n    fitted = bn.fit(res, training.set)     # learning of parameters\n    pred = predict(fitted, \"C\", test.set)  # predicts the value of node C given test set\n    cbind(pred, test.set[, \"C\"])           # compare the actual and predicted\n    accuracy(f = pred, x = test.set[, \"C\"])\n\n            pred          \n [1,]  3.5749952  3.952410\n [2,]  0.7434548  1.443177\n [3,]  5.1731669  5.924198\n [4,] 10.0840800 10.296560\n [5,] 12.3966908 12.268170\n [6,]  9.1834888  9.725431\n [7,]  6.8067145  5.625797\n [8,]  9.9246630  9.597326\n [9,]  5.9426798  6.503896\n[10,] 16.0056136 16.037176\n&gt; accuracy(f = pred, x = test.set[, \"C\"])\n                ME      RMSE       MAE      MPE     MAPE\nTest set 0.1538594 0.5804431 0.4812143 6.172352 11.26223\n</code></pre>\n", "last_activity_date": 1475431982, "answer_id": 39819708, "is_accepted": false, "owner": {"user_id": 1493382, "reputation": 271, "user_type": "registered", "accept_rate": 34, "display_name": "wrtsvkrfm", "link": "http://stackoverflow.com/users/1493382/wrtsvkrfm", "profile_image": "https://www.gravatar.com/avatar/00869c5e4a0851d3d67993f9534a4310?s=128&d=identicon&r=PG&f=1"}, "last_edit_date": 1475431982, "question_id": 39819707}