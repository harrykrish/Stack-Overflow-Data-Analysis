{"body": "<p>I found some of the solutions here to be slow and/or confusing (and some of them don't handle ties correctly) so I wrote my own <code>data.table</code> based function <a href=\"https://github.com/ben519/mltools/blob/master/R/auc_roc.R\" rel=\"nofollow\">auc_roc()</a> in my un-Cran'ed R package <a href=\"https://github.com/ben519/mltools\" rel=\"nofollow\">mltools</a>.</p>\n\n<p>First, either install my package</p>\n\n<pre><code>library(devtools)\ninstall_github(\"ben519/mltools\")\n</code></pre>\n\n<p>Or just copy the function to your environment</p>\n\n<pre><code>auc_roc &lt;- function(preds, actuals, returnDT=FALSE){\n  # Calculate area under the ROC curve\n  # If returnDT = TRUE, a data.table is returned\n\n  # Check if every prediction is identical and if so, return 0.5\n  if(length(unique(preds)) == 1) return(0.5)\n\n  dt &lt;- data.table(Pred=preds, Actual=actuals*1L)\n  setorder(dt, -Pred)\n\n  bg &lt;- dt[, list(CountFalse=sum(Actual==0), CountTrue=sum(Actual)), by=list(Pred)]\n\n  # Calculate the CumulativeFalsePositiveRate and CumulativeTruePositiveRate\n  bg[, CumulativeFPR := cumsum(CountFalse)/sum(CountFalse)]\n  bg[, CumulativeTPR := cumsum(CountTrue)/sum(CountTrue)]\n\n  # Calculate AUC ROC\n  bg[, AdditionalArea := c(head(CumulativeFPR, 1) * head(CumulativeTPR, 1)/2,\n                           (tail(CumulativeFPR, -1) - head(CumulativeFPR, -1)) * (head(CumulativeTPR, -1) + (tail(CumulativeTPR, -1) - head(CumulativeTPR, -1))/2))]\n  bg[, CumulativeArea := cumsum(AdditionalArea)]\n\n  # Return the desired result\n  if(returnDT) return(bg[]) else return(tail(bg$CumulativeArea, 1))\n}\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>library(data.table)\n\npreds &lt;- c(.1, .3, .3, .9)\nactuals &lt;- c(0, 0, 1, 1)\n\nauc_roc(preds, actuals)  # 0.875\n\nauc_roc(preds, actuals, returnDT=TRUE)\nPred CountFalse CountTrue CumulativeFPR CumulativeTPR AdditionalArea CumulativeArea\n1:  0.9          0         1           0.0           0.5          0.000          0.000\n2:  0.3          1         1           0.5           1.0          0.375          0.375\n3:  0.1          1         0           1.0           1.0          0.500          0.875\n</code></pre>\n", "tags": ["r", "machine-learning", "data-mining", "auc"], "creation_date": 1474251236, "score": 0, "last_activity_date": 1474251236, "answer_id": 39564467, "is_accepted": false, "owner": {"user_id": 2146894, "reputation": 3250, "user_type": "registered", "accept_rate": 81, "display_name": "Ben", "link": "http://stackoverflow.com/users/2146894/ben", "profile_image": "https://www.gravatar.com/avatar/1fe765256b6985ff92d0554dbcf021aa?s=128&d=identicon&r=PG"}, "title": "Calculate AUC in R?", "question_id": 4903092}