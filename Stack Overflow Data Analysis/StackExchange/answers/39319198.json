{"title": "Extract the whole text contained in webpage using Chrome extension", "tags": ["javascript", "google-chrome", "google-chrome-extension"], "creation_date": 1473007267, "score": 1, "body": "<p>Well, parsing the webpage is probably going to be easier to do as a DOM instead of plain text.  However, that is not what your question asked.</p>\n\n<p>Your code has issues with how you are navigating to the page and dealing with the asynchronous nature of web navigation. This is also not what your question asked, but impacts how what you did ask about, getting text from a webpage, is implemented.</p>\n\n<p>As such, to answer your question of how to extract the plain text from a webpage, I implemented doing so upon the user clicking a <code>browser_action</code> button. This separates answering how this can be done from the other issues in your code.</p>\n\n<p>As <a href=\"http://stackoverflow.com/users/3959875/woxxom\">wOxxOm</a> mentioned in a comment, to have access to the DOM of a webpage, you have to use a content script. As he did, I suggest you read the <a href=\"https://developer.chrome.com/extensions/overview\" rel=\"nofollow\">Overview of Chrome extensions</a>.  You can inject a content script using <a href=\"https://developer.chrome.com/extensions/tabs#method-executeScript\" rel=\"nofollow\"><code>chrome.tabs.executeScript</code></a>. Normally, you would inject a script contained in a separate file using the <code>file</code> property of the <code>details</code> parameter. For code that is just the simple task of sending back the text of the webpage (without parsing, etc), it is reasonable to just insert the single line of code that is required for the most basic way of doing so. To insert a short segment of code, you can do so using the <code>code</code> property of the <code>details</code> parameter. In this case, given that you have said nothing about your requirements for the text, <code>document.body.innerText</code> is the text returned.</p>\n\n<p>To send the text back to the background script, <a href=\"https://developer.chrome.com/extensions/runtime#method-sendMessage\" rel=\"nofollow\"><code>chrome.runtime.sendMessage()</code></a> is used.  </p>\n\n<p>To receive the text in the background script, a listener, <code>receiveText</code>, is added to <a href=\"https://developer.chrome.com/extensions/runtime#event-onMessage\" rel=\"nofollow\"><code>chrome.runtime.onMessage</code></a>.</p>\n\n<p><em>background.js</em>:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>chrome.browserAction.onClicked.addListener(function(tab) {\n    console.log('Injecting content script(s)');\n    //On Firefox document.body.textContent is probably more appropriate\n    chrome.tabs.executeScript(tab.id,{\n        code: 'document.body.innerText;'\n        //If you had something somewhat more complex you can use an IIFE:\n        //code: '(function (){return document.body.innerText})();'\n        //If your code was actualy complex, you should store it in a\n        // speatate .js file, which you inject with the file: property.\n    },receiveText);\n});\n\n//tabs.executeScript() returns the resluts of the executed script\n//  in an array of results, one entry per frame in which the script\n//  was injected.\nfunction receiveText(resultsArray){\n    console.log(resultsArray[0]);\n}\n</code></pre>\n\n<p><em>manifest.json</em>:</p>\n\n<pre class=\"lang-json prettyprint-override\"><code>{\n    \"description\": \"Gets the text of a webpage and logs it to the console\",\n    \"manifest_version\": 2,\n    \"name\": \"Get Webpage Text\",\n    \"version\": \"0.1\",\n\n    \"permissions\": [\n        \"activeTab\"\n    ],\n\n    \"background\": {\n        \"scripts\": [\n            \"background.js\"\n        ]\n    },\n\n    \"browser_action\": {\n        \"default_icon\": {\n            \"32\": \"myIcon.png\"\n        },\n        \"default_title\": \"Get Webpage Text\",\n        \"browser_style\": true\n    }\n}\n</code></pre>\n", "last_activity_date": 1477765451, "answer_id": 39319198, "is_accepted": true, "owner": {"user_id": 3773011, "reputation": 9017, "user_type": "registered", "display_name": "Makyen", "link": "http://stackoverflow.com/users/3773011/makyen", "profile_image": "https://www.gravatar.com/avatar/268909707f084cf82523e616dd9df570?s=128&d=identicon&r=PG&f=1"}, "last_edit_date": 1477765451, "question_id": 39317541}