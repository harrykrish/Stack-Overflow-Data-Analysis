{"title": "ROW_NUMBER() OVER with sub set", "tags": ["sql", "sql-server", "sql-server-2008"], "creation_date": 1463666845, "score": 0, "body": "<p>P Salmon provided this code which I adopted and the only reason for me posting this answer here is so as to show what I am going to be placing in the stored procedure as a final result. This is working perfectly and enumerating both the sub_idx and alt_sub_idx columns as it should. Below is the actual code I will be using and the results to compare with what was posted in my original post. </p>\n\n<p>Thanks to P Salmon as well as everyone else who contributed here I learned a great deal from everyone!</p>\n\n<pre><code>WITH n AS \n(\nSELECT  DID AS DID,\n        sub_idx AS current_id,\n        ROW_NUMBER() OVER (PARTITION BY EID ORDER BY alt_sub_idx) AS new_id\nFROM    GETT_Documents \n)\n--SELECT * FROM N\nUPDATE  GETT_Documents\n        SET sub_idx = n.new_id\nFROM    GETT_Documents  G\nJOIN    n ON N.DID = G.DID\nWHERE   EID = 'AC-1.1.i';\n</code></pre>\n\n<p>WITH n AS \n    (\n    SELECT  DID AS DID,\n            alt_sub_idx AS current_id,\n            ROW_NUMBER() OVER (PARTITION BY EID ORDER BY sub_idx)*10 AS new_id\n    FROM    GETT_Documents \n    )\n   --SELECT * FROM N\n    UPDATE  GETT_Documents\n            SET alt_sub_idx = n.new_id\n    FROM    GETT_Documents  G\n    JOIN    n ON N.DID = G.DID\n    WHERE   EID = 'AC-1.1.i';</p>\n\n<p><a href=\"http://i.stack.imgur.com/AVwza.jpg\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/AVwza.jpg\" alt=\"the output\"></a></p>\n", "last_activity_date": 1475757775, "answer_id": 37325748, "is_accepted": false, "owner": {"user_id": 5976543, "reputation": 51, "user_type": "registered", "accept_rate": 68, "display_name": "Ken Carter", "link": "http://stackoverflow.com/users/5976543/ken-carter", "profile_image": "https://i.stack.imgur.com/lVba2.jpg?s=128&g=1"}, "last_edit_date": 1475757775, "question_id": 37307353}