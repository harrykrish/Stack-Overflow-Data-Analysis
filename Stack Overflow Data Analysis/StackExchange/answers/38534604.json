{"title": "python Iterative loop through columns of dataframe", "tags": ["python", "loops", "python-3.x", "pandas", "dataframe"], "creation_date": 1469218466, "score": 1, "body": "<p>Do the following:</p>\n\n<ol>\n<li>Sort by store_code, week_hr</li>\n<li>Filter by 0</li>\n<li>Store the subtraction between df['week_hr'][1:].values-df['week_hr'][:-1].values so you will get to know if they are continuos.</li>\n<li><p>Now you can give groups to continuous and filter as you want.</p>\n\n<pre><code>import numpy as np\nimport pandas as pd\n\n# 1\nt1 = df.sort_values(['store_code', 'week_hr'])\n\n# 2\nt2 = t1[t1['baskets'] == 0]\n\n# 3\ncontinuous = t2['week_hr'][1:].values-t2['week_hr'][:-1].values == 1\ngroups = np.cumsum(np.hstack([False, continuous==False]))\nt2['groups'] = groups\n\n# 4\nt3 = t2.groupby(['store_code', 'groups'], as_index=False)['week_hr'].count()\nt4 = t3[t3.week_hr &gt; 2]\nprint pd.merge(t2, t4[['store_code', 'groups']])\n</code></pre></li>\n</ol>\n\n<p>There's no need for looping!</p>\n", "last_activity_date": 1477747678, "answer_id": 38534604, "is_accepted": true, "owner": {"user_id": 2548351, "reputation": 733, "user_type": "registered", "display_name": "caiohamamura", "link": "http://stackoverflow.com/users/2548351/caiohamamura", "profile_image": "https://www.gravatar.com/avatar/ecf190192733e7d4bbaffbd4a1de7580?s=128&d=identicon&r=PG&f=1"}, "last_edit_date": 1477747678, "question_id": 38532978}