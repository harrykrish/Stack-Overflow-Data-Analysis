{"title": "Redirect a user after login with ajax validation to the same page where he was", "tags": ["jquery", "ajax", "wordpress"], "creation_date": 1477562565, "score": 0, "body": "<p><strong>PHP SOLUTION</strong></p>\n\n<p>I presume you are forming the <code>ajax_login_object</code> array in PHP. Probably using</p>\n\n<pre><code>wp_localize_script( 'your_script', 'ajax_login_object' , $ajax_login_object );\n</code></pre>\n\n<p>That is the usual WordPress method of passing data to a front end script anyway.</p>\n\n<p>Try this PHP:</p>\n\n<pre><code>$ajax_login_object['redirecturl'] =\"//\".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']; \n</code></pre>\n\n<p>Or try this from <a href=\"http://www.insertcart.com/get-current-page-url-in-wordpress/\" rel=\"nofollow\">http://www.insertcart.com/get-current-page-url-in-wordpress/</a>:</p>\n\n<pre><code>$ajax_login_object['redirecturl'] = esc_url(the_permalink());\n</code></pre>\n\n<p>Another alternative from <a href=\"http://mekshq.com/get-current-page-url-wordpress/\" rel=\"nofollow\">http://mekshq.com/get-current-page-url-wordpress/</a> is:</p>\n\n<pre><code>global $wp;\n$ajax_login_object['redirecturl'] = home_url(add_query_arg(array(),$wp-&gt;request));\n</code></pre>\n\n<p><strong>JavaScript Solution</strong></p>\n\n<p>This is a pure JavaScript solution.</p>\n\n<p>In JS <code>window.location.href</code> returns the current URL of the page. So in your code you could replace</p>\n\n<pre><code>document.location.href = ajax_login_object.redirecturl;\n</code></pre>\n\n<p>with </p>\n\n<pre><code>document.location.href = window.location.href;\n</code></pre>\n", "last_activity_date": 1477562827, "answer_id": 40281733, "is_accepted": true, "owner": {"user_id": 3003045, "reputation": 1670, "user_type": "registered", "accept_rate": 100, "display_name": "James Jones", "link": "http://stackoverflow.com/users/3003045/james-jones", "profile_image": "https://graph.facebook.com/100001148539277/picture?type=large"}, "last_edit_date": 1477562827, "question_id": 40281472}