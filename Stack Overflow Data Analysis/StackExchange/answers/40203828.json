{"title": "Visual Studio 2015/Linux extension produces a &quot;collect2 : error : ld returned 1 exit status&quot; with Cygwin", "tags": ["c++", "linux", "visual-studio-2015", "cygwin", "ld"], "creation_date": 1477231754, "score": 0, "body": "<p>Ok, found it! Default VS/Linux project options are not suitable for Cygwin:</p>\n\n<p>When switching the VS project build output from \"minimal\" (the default) to \"normal\" I could notice there was a problem with the generated <code>ld</code> command line:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Po0IQ.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/Po0IQ.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>1&gt;       Link:\n1&gt;         Linking objects\n1&gt;         Invoking ld\n1&gt;         g++ -o \"/home/xxxxx/projects/xxxxxx/bin/x86/Release/xxxxx.out\" -Wl,--no-undefined -Wl,-z,relro -Wl,-z,now -Wl,-z,noexecstack /home/xxxxx/projects/xxxxx/obj/x86/Release/main.o\n1&gt;         /bin/ld: unrecognized option '-z'\n1&gt;         /bin/ld: use the --help option for usage information\n1&gt;         collect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>The <code>-z</code> option is <a href=\"https://www.cygwin.com/ml/cygwin/2010-01/msg00717.html\" rel=\"nofollow\">not implemented on Cygwin</a> and <a href=\"https://www.cygwin.com/ml/cygwin/2010-01/msg00719.html\" rel=\"nofollow\">won't be</a>. So it has to be removed from the VS linker options where it is used by default:</p>\n\n<p>Before:\n<a href=\"https://i.stack.imgur.com/ylHqG.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/ylHqG.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:\n<a href=\"https://i.stack.imgur.com/euK8P.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/euK8P.png\" alt=\"enter image description here\"></a>\n(<em>Note 1</em>: the third one has to be manually set to blank as both proposed options use <code>-z</code>)<br />\n(<em>Note 2</em>: all other differences between these two screenshots are not tied to this problem. The first is my <code>release</code> configuration, kept by default, where the second is my <code>debug</code> configuration, that uses verbose and print-map.)</p>\n\n<p>Now everything runs well:\n<a href=\"https://i.stack.imgur.com/GUrkj.png\" rel=\"nofollow\"><img src=\"https://i.stack.imgur.com/GUrkj.png\" alt=\"enter image description here\"></a></p>\n\n<p>The program is properly built, it works, and the link with GDB works fine too in debug mode.</p>\n\n<p>Caveat: this <code>-z</code> thing might be an issue when switching from Cygwin to standard Linux platforms later on.</p>\n", "last_activity_date": 1477323370, "answer_id": 40203828, "is_accepted": true, "owner": {"user_id": 840960, "reputation": 7963, "user_type": "registered", "accept_rate": 100, "display_name": "Shlublu", "link": "http://stackoverflow.com/users/840960/shlublu", "profile_image": "https://www.gravatar.com/avatar/c79d55b76b6994dec3fb96bd1c7803bf?s=128&d=identicon&r=PG"}, "last_edit_date": 1477323370, "question_id": 40196983}