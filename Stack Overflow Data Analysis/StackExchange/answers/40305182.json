{"body": "<p>You can break the <code>[Order Amount Range]</code> out into a <code>CROSS APPLY</code> for use throughout your statement.</p>\n\n<p>For the ordering, the simplest option is to use <code>[order].[totalamout]</code> which is already numerically useful and matches the order of your ranges correctly.</p>\n\n<pre><code>SELECT\n    [range].[Order Amount Range],\n    Count(*) AS [Total Orders]\n\nFROM [order]\n\nCROSS APPLY (\n    SELECT\n        CASE\n            WHEN [order].[totalamount] BETWEEN 0 AND 49 THEN ' 0 - 49'\n            WHEN [order].[totalamount] BETWEEN 50 AND 99 THEN ' 50 - 99'\n            WHEN [order].[totalamount] BETWEEN 100 AND 149 THEN ' 100 - 149'\n            WHEN [order].[totalamount] BETWEEN 150 AND 199 THEN ' 150 - 199'\n            WHEN [order].[totalamount] BETWEEN 200 AND 249 THEN ' 200 - 249'\n            WHEN [order].[totalamount] BETWEEN 250 AND 299 THEN ' 250 - 299'\n            WHEN [order].[totalamount] BETWEEN 300 AND 349 THEN ' 300 - 349'\n            WHEN [order].[totalamount] BETWEEN 350 AND 399 THEN ' 350 - 399'\n            WHEN [order].[totalamount] BETWEEN 400 AND 449 THEN ' 400 - 449'\n            ELSE 'Above 500'\n        END AS [Order Amount Range]\n    ) as [range]\n\nGROUP  [range].[Order Amount Range]\n\nORDER  BY [order].[totalamount]\n</code></pre>\n", "tags": ["sql", "sql-server", "tsql", "sorting"], "creation_date": 1477657883, "score": 0, "last_activity_date": 1477657883, "answer_id": 40305182, "is_accepted": false, "owner": {"user_id": 1849866, "reputation": 771, "user_type": "registered", "display_name": "Edward Comeau", "link": "http://stackoverflow.com/users/1849866/edward-comeau", "profile_image": "https://i.stack.imgur.com/6xUJ6.jpg?s=128&g=1"}, "title": "Sorting in SQL Server query with Case Statement", "question_id": 40299059}