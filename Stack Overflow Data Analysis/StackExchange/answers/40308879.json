{"body": "<p>OK I figured it out. Using what Jovan Perovic suggested, I came up with this:</p>\n\n<pre><code>{% set allAttr = [\"A\",\"B\",\"D\",\"L1\",\"L2\"] %}\n{% set prodAtts = [] %}\n{% for row in data %}\n    {% set existingAtts = [] %}\n    {% for att in allAttr %}\n        {% if att not in prodAtts %}\n            {% set prodAtts = prodAtts|merge([att]) %}\n        {% endif %}\n    {% endfor %}\n    {% for rowAtt in row.product.attributes %}\n        {% set existingAtts = existingAtts|merge({(rowAtt.attributeName.name|trim):(rowAtt.attributeName.name|trim~'_'~rowAtt.text|trim)}) %}\n    {% endfor %}\n    {% for prodAtt in prodAtts %}\n        {% if prodAtt not in existingAtts|keys %}\n            {% set existingAtts = existingAtts|merge({(prodAtt):(prodAtt~'_na')}) %}\n        {% endif %}\n    {% endfor %}\n        {% set orderedAtts = existingAtts|sort %}\n....\n</code></pre>\n\n<p>Then the loop for each row thereafter. I used the attribute name with an underscore in order to be able to sort it correct (as it only sorts by value not key) then used preg_replace to remove it along with any instance of the name so I just ended up with the value.</p>\n\n<p>Bit of a lengthy - and probably over thought - solution but it does work!</p>\n", "tags": ["symfony2", "csv", "twig"], "creation_date": 1477670251, "score": 0, "last_activity_date": 1477670251, "answer_id": 40308879, "is_accepted": false, "owner": {"user_id": 5194337, "reputation": 228, "user_type": "registered", "accept_rate": 55, "display_name": "Michael Emerson", "link": "http://stackoverflow.com/users/5194337/michael-emerson", "profile_image": "https://www.gravatar.com/avatar/40adef5b136fb6ff24ba8aad7f636a52?s=128&d=identicon&r=PG"}, "title": "Looping through values in twig and replacing empty values", "question_id": 40289756}