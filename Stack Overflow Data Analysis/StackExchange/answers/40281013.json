{"title": "Complex Case Statement Issue - Oracle SQL", "tags": ["sql", "oracle"], "creation_date": 1477560699, "score": 2, "body": "<p>This is one way you could do it:</p>\n\n<pre><code>SELECT cust.store,\n       cust.custid,\n       cust.id_cust,\n       gift.giftamt,\n       gift.custgift,\n       cpn.couponamt,\n       sprt.sportsamt\nFROM   cust\n       LEFT OUTER JOIN (SELECT id_cust,\n                               SUM(CASE WHEN cg.code_status = 'C' AND gi.flag_store_loc = 'N' THEN cg.amt_paid END) giftamt,\n                               SUM(CASE WHEN cg.code_status = 'C' AND gi.flag_store_loc = 'Y' THEN cg.amt_paid END) custgiftamt\n                        FROM   cust_gift cg\n                               INNER JOIN gift_item gi ON cg.id_gift_item = gi.id_gift_item) gift ON cust.id_cust = gift.id_cust\n       LEFT OUTER JOIN (SELECT id_cust,\n                               SUM(CASE WHEN code_status = 'C' THEN amt END) couponamt\n                        FROM   cust_coupon) cpn ON cust.id_cust = cpn.id_cust\n       LEFT OUTER JOIN (SELECT id_cust,\n                               SUM(CASE WHEN status = 'C' THEN amt END) sportsamt\n                        FROM   cust_sports) sprt ON cust.id_cust = sprt.id_cust\nWHERE  (STORE = 'M669098' OR STORE = 'M66923434');\n</code></pre>\n", "last_activity_date": 1477640553, "answer_id": 40281013, "is_accepted": true, "owner": {"user_id": 4479309, "reputation": 10938, "user_type": "registered", "display_name": "Boneist", "link": "http://stackoverflow.com/users/4479309/boneist", "profile_image": "https://www.gravatar.com/avatar/4c4d654c7c3c81918b62d9a30212daa2?s=128&d=identicon&r=PG"}, "last_edit_date": 1477640553, "question_id": 40275022}