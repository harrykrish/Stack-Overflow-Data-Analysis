{"body": "<p>Thanks @Striezel, your feedback pointed me in the right direction. After investigating your solution, I run into this post: <a href=\"http://stackoverflow.com/questions/3909713/xlib-xgetwindowattributes-always-returns-1x1\">Xlib: XGetWindowAttributes always returns 1x1?</a></p>\n\n<p>Tweaking the answer from @Doug a little bit I've got following, which seems to be working as expected:</p>\n\n<pre><code>Window getToplevelParent(Display* display, Window window)\n{\n    Window parentWindow;\n    Window rootWindow;\n    Window* childrenWindows;\n    unsigned int numberOfChildren;\n\n    while (1) {\n        if (XQueryTree(display, window, &amp;rootWindow, &amp;parentWindow, &amp;childrenWindows,\n                       &amp;numberOfChildren) == 0) {\n            qCritical(\"ImageGrabber::getToplevelParent: XQueryTree Error\");\n            return 0;\n        }\n        if (childrenWindows) {\n            XFree(childrenWindows);\n        }\n        if (window == rootWindow || parentWindow == rootWindow) {\n            return window;\n        } else {\n            window = parentWindow;\n        }\n    }\n}\n\nQRect ImageGrabber::getActiveWindowRect()\n{\n\n    Display* display = XOpenDisplay(NULL);\n    Window focusWindow, parentOfFocusedWindow;\n    XWindowAttributes attrributes;\n    int revert;\n\n    XGetInputFocus(display, &amp;focusWindow, &amp;revert);\n    parentOfFocusedWindow = getToplevelParent(display, focusWindow);\n    if (!parentOfFocusedWindow) {\n        qCritical(\"ImageGrabber::getActiveWindowRect: Unable to get window, returning screen.\");\n        return getCurrectScreenRect();\n    }\n\n    XGetWindowAttributes(display, parentOfFocusedWindow, &amp;attrributes);\n    return QRect(attrributes.x, attrributes.y, attrributes.width, attrributes.height);\n} \n</code></pre>\n", "tags": ["c++", "linux", "qt"], "creation_date": 1474131060, "score": 0, "last_activity_date": 1474131060, "answer_id": 39549363, "is_accepted": false, "owner": {"user_id": 6659494, "reputation": 50, "user_type": "registered", "accept_rate": 71, "display_name": "dporobic", "link": "http://stackoverflow.com/users/6659494/dporobic", "profile_image": "https://i.stack.imgur.com/gaAXg.jpg?s=128&g=1"}, "title": "How to get Geometry of currently focused Window on Linux in C++?", "question_id": 39547361}