{"title": "AngularJS - Unable to get Resolved Value of a Factory&#39;s Method which Uses Promises in Directive&#39;s TemplateUrl", "tags": ["javascript", "angularjs", "asynchronous", "angularjs-directive", "promise"], "creation_date": 1473158295, "score": 0, "body": "<p>I managed to fix the issue using a <code>link</code> function and <code>$templateRequest</code></p>\n\n<p><strong>Directive</strong></p>\n\n<pre><code>link: function (scope, element) {\n      SessionCheckerService.renderTemplate().then(function (temp){\n        $templateRequest(temp).then(function (requestedTemplate) {\n          element.html(requestedTemplate);\n          $compile(element.contents())(scope);\n        });\n      });\n    }\n</code></pre>\n\n<p><strong>Factory</strong></p>\n\n<pre><code>var templateConfig = './app/config/templates.config.json';\n\nfunction getTemplate(){\n  return $http.get(templateConfig)\n    .then(function(templates) {\n      return templates.data;\n    });\n}\n\nfunction checkSession() {\n  return Promise.resolve(AuthTokenFactory.isAuth());\n}\n\nfunction whichTemplate(template, result) {\n  var myTemplate = '';\n  if(result){\n     myTemplate = template.logIn;\n  } else {\n     myTemplate = template.logOut;\n  }\n    if(myTemplate){\n       return Promise.resolve(myTemplate);\n    }\n\n }\n\n//Chaining the methods and returning the correct template\nfunction renderTemplate() {\n  return new Promise(function (resolve) {\n     checkSession().then(function(isAuth){\n       getTemplate().then( function(templates){\n         whichTemplate(templates, isAuth).then( function (temp) {\n           return resolve(temp);\n         });\n       });\n     });\n   });\n }\n\n return {\n   renderTemplate : renderTemplate\n }\n</code></pre>\n\n<p><strong>Templates Config</strong></p>\n\n<pre><code>{\n  \"logOut\" : \"app/page1.html\",\n  \"logIn\"  : \"app/page2.html\"\n}\n</code></pre>\n\n<p>I hope It'll be helpful.</p>\n", "last_activity_date": 1473158894, "answer_id": 39346963, "is_accepted": true, "owner": {"user_id": 4684539, "reputation": 790, "user_type": "registered", "accept_rate": 100, "display_name": "AndreaM16", "link": "http://stackoverflow.com/users/4684539/andream16", "profile_image": "https://i.stack.imgur.com/JT5Np.png?s=128&g=1"}, "last_edit_date": 1473158894, "question_id": 39343007}