{"title": "Socket.IO - how do I get a list of connected sockets/clients?", "tags": ["node.js", "socket.io"], "creation_date": 1402415262, "score": 65, "body": "<p>As of socket.io 1.0, the actual accepted answer isn't valid anymore.\nSo I made a small function that I use as a temporary fix :</p>\n\n<pre><code>function findClientsSocket(roomId, namespace) {\n    var res = []\n    // the default namespace is \"/\"\n    , ns = io.of(namespace ||\"/\");\n\n    if (ns) {\n        for (var id in ns.connected) {\n            if(roomId) {\n                var index = ns.connected[id].rooms.indexOf(roomId);\n                if(index !== -1) {\n                    res.push(ns.connected[id]);\n                }\n            } else {\n                res.push(ns.connected[id]);\n            }\n        }\n    }\n    return res;\n}\n</code></pre>\n\n<p>Api for <strong>No namespace</strong> becomes </p>\n\n<pre><code>// var clients = io.sockets.clients();\n// becomes : \nvar clients = findClientsSocket();\n\n// var clients = io.sockets.clients('room');\n// all users from room `room`\n// becomes\nvar clients = findClientsSocket('room');\n</code></pre>\n\n<p>Api for <strong>a namespace</strong> becomes :</p>\n\n<pre><code>// var clients = io.of('/chat').clients();\n// becomes\nvar clients = findClientsSocket(null, '/chat');\n\n// var clients = io.of('/chat').clients('room');\n// all users from room `room`\n// becomes\nvar clients = findClientsSocket('room', '/chat');\n</code></pre>\n\n<p>Also see this <a href=\"http://stackoverflow.com/questions/23858604/how-to-get-rooms-clients-list-in-socket-io-1-0/24034949#24034949\">related question</a>, in which I give a function that returns the sockets for a given room.</p>\n\n<pre><code>function findClientsSocketByRoomId(roomId) {\nvar res = []\n, room = io.sockets.adapter.rooms[roomId];\nif (room) {\n    for (var id in room) {\n    res.push(io.sockets.adapter.nsp.connected[id]);\n    }\n}\nreturn res;\n}\n</code></pre>\n", "last_activity_date": 1476885901, "answer_id": 24145381, "is_accepted": false, "owner": {"user_id": 1327651, "reputation": 6454, "user_type": "registered", "accept_rate": 90, "display_name": "nha", "link": "http://stackoverflow.com/users/1327651/nha", "profile_image": "https://i.stack.imgur.com/ZDXNZ.png?s=128&g=1"}, "last_edit_date": 1476885901, "question_id": 6563885}