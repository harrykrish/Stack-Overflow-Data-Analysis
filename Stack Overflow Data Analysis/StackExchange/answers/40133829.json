{"title": "Searching page and replacing some elements", "tags": ["php", "regex"], "creation_date": 1476886268, "score": 1, "body": "<p>Here's your answer (I've also made it a bit more robust):</p>\n\n<pre><code>{tip(?:\\s+class\\s*=\\s*\"([a-zA-Z\\s]+)\")?}([^{]*){\\/tip}\n</code></pre>\n\n<p>PCRE (which PHP uses, if memory serves) will automatically pick up that the first capture group (which grabs the classes) is empty in the first case, and just substitute the empty string in the replacement. The second case is self-explanatory.</p>\n\n<p>Your replacement code, then, will look like this:</p>\n\n<pre><code>$article-&gt;text = preg_replace(\n    '/{tip(?:\\s+class\\s*=\\s*\"([a-zA-Z\\s]+)\")?}([^}]*){\\/tip}/',\n    '&lt;span class=\"tooltip $1\"&gt;&lt;i&gt;?&lt;/i&gt;&lt;em&gt;$2&lt;/em&gt;&lt;/span&gt;',\n    $article-&gt;text\n);\n</code></pre>\n\n<p>Yout don't need to check if the regex matches beforehand - that's implied by <code>preg_replace</code>, which is performing a <em>regex match</em> and then replacing any text matched by the pattern with that text. If there are no matches, no replacement occurs.</p>\n\n<ul>\n<li><a href=\"https://regex101.com/r/iZ3idB/3\" rel=\"nofollow\">Regex Demo on Regex101</a></li>\n<li><a href=\"https://repl.it/EA7J/2\" rel=\"nofollow\">Code Demo on repl.it</a></li>\n</ul>\n", "last_activity_date": 1476888504, "answer_id": 40133829, "is_accepted": true, "owner": {"user_id": 5103620, "reputation": 3169, "user_type": "registered", "accept_rate": 100, "display_name": "Sebastian Lenartowicz", "link": "http://stackoverflow.com/users/5103620/sebastian-lenartowicz", "profile_image": "https://www.gravatar.com/avatar/8ae06ea53a316cc879b9100b3ff25bfc?s=128&d=identicon&r=PG"}, "last_edit_date": 1476888504, "question_id": 40133371}