{"body": "<p>Based on your comments, for any number the start of the period is the earliest call from that number. \nBelow is the commented code:</p>\n\n<pre><code>library(lubridate)                                                              \nlibrary(dplyr)          \n\ncalls &lt;- structure(list(Date_Time = structure(1:6, .Label = c(\"12/1/2015 12:00:01 AM\", \n\"12/1/2015 12:00:29 AM\", \"12/1/2015 12:00:41 AM\", \"12/1/2015 12:00:43 AM\", \n\"12/1/2015 9:00:02 AM\", \"12/2/2015 12:00:02 AM\"), class = \"factor\"), \n    Number = structure(c(4L, 3L, 2L, 1L, 4L, 3L), .Label = c(\"12222222\", \n    \"22333333\", \"32211111\", \"92222222\"), class = \"factor\")), .Names = c(\"Date_Time\", \n\"Number\"), row.names = c(NA, -6L), class = \"data.frame\")\n\n\ncount_freq &lt;- function(timestamps){                                             \n    #Given all the ocurrences of calls from a number find the \n    #earliest one and count how many occur within 24 hours\n    dtime &lt;- sort(mdy_hms(timestamps))                                            \n    start_time &lt;- dtime[1]                                                        \n    end_time &lt;- start_time + hours(24)                                            \n    sum(dtime &gt;= start_time &amp; dtime &lt;= end_time)                                  \n}\n\n\nout &lt;- group_by(calls, Number) %&gt;% \n       summarise(freq = count_freq(Date_Time)) \n</code></pre>\n", "tags": ["r", "datetime"], "creation_date": 1459866043, "score": 1, "last_activity_date": 1459866043, "answer_id": 36429092, "is_accepted": true, "owner": {"user_id": 4787876, "reputation": 351, "user_type": "registered", "display_name": "tfc", "link": "http://stackoverflow.com/users/4787876/tfc", "profile_image": "https://www.gravatar.com/avatar/11e4ce6858fd30ea33c729103cf4b77f?s=128&d=identicon&r=PG&f=1"}, "title": "Count number of occurrence within time frame in R", "question_id": 36426671}