{"body": "<p>Following code is now working:</p>\n\n<pre><code>Private Sub Command6_Click()\n\nDim rs As DAO.Recordset\nDim sourcePATH As String\nDim destinPATH As String\nDim StrSQL As String\nDim strFileName As String\nDim exten As String\nDim source As String\nDim destin As String\n\nsourcePATH = \"D:\\1\\\"\ndestinPATH = \"D:\\2\\\"\nStrSQL = \"SELECT RT.STRT, RT.IDRT \" &amp; _\n            \"FROM RT \" &amp; _\n            \"WHERE (((RT.STRT) = \" &amp; Me.Text2 &amp; \"))\"\n\nSet rs = CurrentDb.OpenRecordset(StrSQL)\nrs.MoveFirst\nDo Until rs.EOF\nstrFileName = Dir(sourcePATH &amp; rs!IDRT &amp; \".*\")\nIf Len(strFileName) = 0 Then\nrs.MoveNext\nElse\nexten = Right(strFileName, Len(strFileName) - InStrRev(strFileName, \".\"))\nsource = sourcePATH &amp; rs!IDRT &amp; \".\" &amp; exten\ndestin = destinPATH &amp; rs!IDRT &amp; \".\" &amp; exten\nFileCopy source, destin\nrs.MoveNext\nEnd If\nLoop\nrs.Close\nSet rs = Nothing\nSet db = Nothing\nEnd Sub\n</code></pre>\n", "tags": ["vba", "loops", "access", "copyfile"], "creation_date": 1477685862, "score": 0, "last_activity_date": 1477685862, "answer_id": 40312651, "is_accepted": false, "owner": {"user_id": 6944707, "reputation": 1, "user_type": "registered", "display_name": "Sohaib Ahmed Siddiqui", "link": "http://stackoverflow.com/users/6944707/sohaib-ahmed-siddiqui", "profile_image": "https://lh5.googleusercontent.com/-zzWRXImFRBc/AAAAAAAAAAI/AAAAAAAAAHg/GfdH6FKVbj8/photo.jpg?sz=128"}, "title": "Loop and copyfile combined in access 2016 vba", "question_id": 40277083}