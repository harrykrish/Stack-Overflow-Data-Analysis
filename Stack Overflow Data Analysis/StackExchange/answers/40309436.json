{"body": "<p>So I made some headway on this. It's not idempotent, but it works. The code was tailored for my use case, but shouldn't be too hard for you to tweak for your own.</p>\n\n<pre><code>import java.util.Arrays\nimport java.util.logging.Logger\nLogger logger = Logger.getLogger(\"ecs-cluster\")\n\nlogger.info(\"Loading Jenkins\")\nimport jenkins.model.*\ninstance = Jenkins.getInstance()\n\nimport com.cloudbees.jenkins.plugins.amazonecs.ECSTaskTemplate.MountPointEntry\ndef mounts = Arrays.asList(\n  new MountPointEntry(\n    name=\"docker\",\n    sourcePath=\"/var/run/docker.sock\",\n    containerPath=\"/var/run/docker.sock\",\n    readOnly=false),\n  new MountPointEntry(\n    name=\"jenkins\",\n    sourcePath=\"/home/jenkins\",\n    containerPath=\"/home/jenkins\",\n    readOnly=false),\n)\n\nlogger.info(\"Creating template\")\nimport com.cloudbees.jenkins.plugins.amazonecs.ECSTaskTemplate\ndef ecsTemplate = new ECSTaskTemplate(\n  templateName=\"jnlp-slave-with-docker\",\n  label=\"ecs-with-docker\",\n  image=\"jnlp-slave-with-docker:latest\",\n  remoteFSRoot=null,\n  memory=2048,\n  cpu=512,\n  privileged=false,\n  logDriverOptions=null,\n  environments=null,\n  extraHosts=null,\n  mountPoints=mounts\n)\n\nlogger.info(\"Retrieving ecs cloud config by descriptor\")\nimport com.cloudbees.jenkins.plugins.amazonecs.ECSCloud\necsCloud = new ECSCloud(\n  name=\"name\",\n  templates=Arrays.asList(ecsTemplate),\n  credentialsId=null,\n  cluster=\"arn:aws:ecs:us-east-1:123456789:cluster/ecs-jenkins-slave\",\n  regionName=\"us-east-1\",\n  jenkinsUrl=\"https://my-jenkins.com\",\n  slaveTimoutInSeconds=60\n)\n\nlogger.info(\"Gettings clouds\")\ndef clouds = instance.clouds\nclouds.add(ecsCloud)\nlogger.info(\"Saving jenkins\")\ninstance.save()\n</code></pre>\n", "tags": ["jenkins", "groovy", "amazon-ecs"], "creation_date": 1477672464, "score": 1, "last_activity_date": 1477672464, "answer_id": 40309436, "is_accepted": true, "owner": {"user_id": 7086324, "reputation": 26, "user_type": "registered", "display_name": "Jason R", "link": "http://stackoverflow.com/users/7086324/jason-r", "profile_image": "https://www.gravatar.com/avatar/2a3e93bb37b6e26c077b102269b4578b?s=128&d=identicon&r=PG&f=1"}, "title": "Configure amazon-ecs slave plugin using Groovy on Jenkins", "question_id": 40059428}