{"title": "Copy a range of values and paste them concatenated by commas", "tags": ["vba", "excel-vba"], "creation_date": 1472473460, "score": 1, "body": "<p>This works for me: first you define the worksheet and get the data. Then you put it into a csv row by row (with de for each loop).</p>\n\n<p>In the example data in your question you already have the values separated by commas, but if you work in another language you may need the data to be separated by semicolons. In that case you should use the Replace sentence that I've left commented before the print sentence.</p>\n\n<p>I hope it helps you.</p>\n\n<pre><code>Sub datos_a_csv()\nDim data, initial_row, final_row\n\n'defines worksheet\nDim H_data As Worksheet\nSet H_data = ThisWorkbook.Worksheets(\"Hoja1\")\n\ninitial_row = 1\nfinal_row = H_data.Cells(initial_row, 1).End(xlDown).Row + 1\n\n'get the data\ndata = H_data.Cells(initial_row, 1).Resize(final_row - initial_row, 1)\n\n'put the data in csv\nMy_filenumber = FreeFile\n\nOpen \"C:\\prueba\\prueba.csv\" For Append As #My_filenumber\n    For Each Row In data\n       'Row=replace(row,\",\",\";\")\n        Print #My_filenumber, Row\n    Next Row\nClose #My_filenumber\n\nEnd Sub\n</code></pre>\n\n<p>If you want to get the columns until the Z column, then:</p>\n\n<pre><code>data = H_data.Cells(initial_row, 1).Resize(final_row - initial_row, 26)\n</code></pre>\n\n<p>and then you should concatenate and store like this\n'put the data in csv\n    My_filenumber = FreeFile\n    Open \"C:\\prueba\\prueba.csv\" For Append As #My_filenumber</p>\n\n<pre><code>for i = lbound(data ,1) to  ubound(data ,1) \n    row=\"\"\n    for j = lbound(data ,1) to  ubound(data ,1) \n        row = row + \",\" + data(i,j)\n    next j\n    Print #My_filenumber, Row\nnext i\nClose #My_filenumber\n</code></pre>\n", "last_activity_date": 1472537815, "answer_id": 39206282, "is_accepted": true, "owner": {"user_id": 3747824, "reputation": 191, "user_type": "registered", "display_name": "m  e", "link": "http://stackoverflow.com/users/3747824/m-e", "profile_image": "https://www.gravatar.com/avatar/af45cd0dc3eac8e267754d1a23e703e3?s=128&d=identicon&r=PG&f=1"}, "last_edit_date": 1472537815, "question_id": 39205646}