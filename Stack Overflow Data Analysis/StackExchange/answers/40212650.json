{"title": "GoogleApiClient showing null pointer error", "tags": ["android", "google-maps"], "creation_date": 1477293380, "score": 1, "body": "<p>Replace your onCreate method with the following code:</p>\n\n<pre><code>private static final int MY_PERMISSION_REQUEST_CODE = 1;\n\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_navigation_drawer);\n    Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);\n    setSupportActionBar(toolbar);\n    context = NavigationDrawerActivity.this;\n\n    DrawerLayout drawer = (DrawerLayout) findViewById(R.id.drawer_layout);\n    ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(\n            this, drawer, toolbar, R.string.navigation_drawer_open, R.string.navigation_drawer_close);\n    drawer.setDrawerListener(toggle);\n    toggle.syncState();\n\n    NavigationView navigationView = (NavigationView) findViewById(R.id.nav_view);\n    navigationView.setNavigationItemSelectedListener(this);\n    View hView = navigationView.getHeaderView(0);\n\n\n    ownProfilePic = (ImageView) hView.findViewById(R.id.ownImageShowDrawerHeaderIvId_navigationDrawer);\n    ownNameShow = (TextView) hView.findViewById(R.id.showUserNameTvId_navigationDrawer);\n\n    /******************************   own profile name and image show **************************  */\n\n\n    ownNameShow.setText(UserInfo.getOwnProfileName());\n    //        new ImageDownloaderTask(ownProfilePic).execute(UserInfo.ownProfilePicUrl);\n    Picasso.with(context).load(UserInfo.getOwnProfilePicUrl()).resize(100, 100).placeholder(R.drawable.profile_show).error(R.drawable.profile_show).transform(new CircleTransform()).into(ownProfilePic);\n\n    // Obtain the SupportMapFragment and get notified when the map is ready to be used.\n    SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager()\n            .findFragmentById(R.id.map);\n    mapFragment.getMapAsync(this);\n\n    if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED &amp;&amp; ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {\n        ActivityCompat.requestPermissions(\n                this,\n                new String[]{\n                        Manifest.permission.ACCESS_FINE_LOCATION,\n                        Manifest.permission.ACCESS_COARSE_LOCATION\n                },\n                MY_PERMISSION_REQUEST_CODE\n        );\n        return;\n    } else {\n        setupLocation();\n    }\n\n    // ATTENTION: This was auto-generated to implement the App Indexing API.\n    // See https://g.co/AppIndexing/AndroidStudio for more information.\n    if (client == null)\n        client = new GoogleApiClient.Builder(this)\n                .addOnConnectionFailedListener(this)\n                .addConnectionCallbacks(this)\n                .addApi(AppIndex.API)\n                .build();\n\n    //route\n}\n\n@Override\npublic void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\n    super.onRequestPermissionsResult(requestCode, permissions, grantResults);\n    switch (requestCode) {\n        case MY_PERMISSION_REQUEST_CODE:\n            if (grantResults[0] == PackageManager.PERMISSION_DENIED || grantResults[1] == PackageManager.PERMISSION_DENIED) {\n                // TODO\n                finish();\n                return;\n            }\n\n            setupLocation();\n            break;\n    }\n}\n\nprivate void setupLocation() {\n    this.lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);\n\n    Criteria criteria = new Criteria();\n    provider = lm.getBestProvider(criteria, false);\n    location = this.lm.getLastKnownLocation(provider);\n    this.locationListener = new NavigationDrawerActivity();\n    this.lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 5000, 5, locationListener);\n\n\n    if (location != null) {\n\n        setUpMapIfNeeded(location);\n        updateUserLatLong(location);\n\n    }\n}\n</code></pre>\n", "last_activity_date": 1477298092, "answer_id": 40212650, "is_accepted": false, "owner": {"user_id": 4583267, "reputation": 848, "user_type": "registered", "accept_rate": 88, "display_name": "SuperThomasLab", "link": "http://stackoverflow.com/users/4583267/superthomaslab", "profile_image": "https://i.stack.imgur.com/pWbGz.png?s=128&g=1"}, "last_edit_date": 1477298092, "question_id": 40212549}