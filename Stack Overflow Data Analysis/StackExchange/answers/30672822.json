{"title": "Shiro complaining &quot;There is no session with id xxx&quot; with DefaultSecurityManager", "tags": ["security", "shiro"], "creation_date": 1433526660, "score": 3, "body": "<p>I was getting this error and found that completely destroying any existing session before calling <code>subject.login(credentials)</code> fixed it.</p>\n\n<pre><code>// Login the user\nprivate Subject loginUser()\n{\n  ensureUserIsLoggedOut();\n  Subject subject = SecurityUtils.getSubject();\n  subject.login(credentials);\n}\n</code></pre>\n\n<p>And the supporting routines are:</p>\n\n<pre><code>// Logout the user fully before continuing.\nprivate void ensureUserIsLoggedOut()\n{\n    try\n    {\n        // Get the user if one is logged in.\n        Subject currentUser = SecurityUtils.getSubject();\n        if (currentUser == null)\n            return;\n\n        // Log the user out and kill their session if possible.\n        currentUser.logout();\n        Session session = currentUser.getSession(false);\n        if (session == null)\n            return;\n\n        session.stop();\n    }\n    catch (Exception e)\n    {\n        // Ignore all errors, as we're trying to silently \n        // log the user out.\n    }\n}\n</code></pre>\n", "last_activity_date": 1472557694, "answer_id": 30672822, "is_accepted": true, "owner": {"user_id": 26510, "reputation": 14100, "user_type": "registered", "accept_rate": 99, "display_name": "Brad Parks", "link": "http://stackoverflow.com/users/26510/brad-parks", "profile_image": "https://www.gravatar.com/avatar/25ee9a1b9f5a16feb1432882a9ef2f06?s=128&d=identicon&r=PG"}, "last_edit_date": 1472557694, "question_id": 14516851}