{"title": "Split Period-Delimited Nodes To JSON Object", "tags": ["json", "powershell"], "creation_date": 1477629766, "score": 1, "body": "<p>To complement <a href=\"http://stackoverflow.com/a/40269687/45375\">TessellatingHeckler's great answer</a> with an alternative implementation that uses a <em>recursive function</em>.  </p>\n\n<p>The emphasis is on modularity and terseness, not performance (to my surprise, however, the OP tells us in a comment that this solution happens to be much faster than TessellatingHeckler's single-loop solution).<br>\nGenerally, using the pipeline for simple enumerations (instead of a <code>foreach</code> loops) is convenient and elegant, but slow).</p>\n\n<pre><code># Outer function that loops over all paths and builds up a single, nested\n# hashtable reflecting the path hierarchy that is converted to JSON on output.\n# NOTE: Assumes that all paths start with the same root component.\nfunction convert-PathsToNestedJsonObject([string[]] $paths) {\n  $ht = @{} \n  $paths | % { convert-PathToNestedHashtable $ht $_ }\n  $ht | ConvertTo-Json -Depth 100\n}\n\n# Recursive helper function that takes a path such as \"appsystem.applications\"\n# and converts it into a nested hashtable with keys \"name\" and \"children\" to\n# reflect the path hierarchy. \nfunction convert-PathToNestedHashtable([hashtable] $ht, [string] $path) {\n  $name, $childName, $rest = $path -split '\\.', 3\n  $ht.name = $name\n  if ($childName) {\n    if ($ht.children) { \n      $htChild = $ht.children | ? { $_.name -eq $childName }\n    } else {\n      $ht.children = New-Object Collections.ArrayList\n      $htChild = $null\n    }\n    if (-not $htChild) {      \n      $null = $ht.children.Add(($htChild = @{}))\n    }\n    convert-PathToNestedHashtable $htChild \"$childName.$rest\" \n  }\n}\n\n# Call the outer function with the input paths (assumed to be stored in $paths).\nconvert-PathsToNestedJsonObject $paths\n</code></pre>\n", "last_activity_date": 1477663552, "answer_id": 40298151, "is_accepted": true, "owner": {"user_id": 45375, "reputation": 47202, "user_type": "registered", "display_name": "mklement0", "link": "http://stackoverflow.com/users/45375/mklement0", "profile_image": "https://www.gravatar.com/avatar/39f6e2dc52425b1e08027c01bb880be0?s=128&d=identicon&r=PG"}, "last_edit_date": 1477663552, "question_id": 40268216}