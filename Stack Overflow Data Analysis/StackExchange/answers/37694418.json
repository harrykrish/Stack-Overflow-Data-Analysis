{"body": "<p>The issue here is you are creating a schema with all the fields/columns type defaulted to <strong>StringType</strong>. But while passing the values in the schema, the value of <strong>Id</strong> and <strong>Age</strong> is being converted to Integer as per the code.Hence, throwing the Matcherror while running.</p>\n\n<p>The data types of columns in the schema should match the data type of values being passed to it. Try the below code.</p>\n\n<pre><code>val sqlContext = new org.apache.spark.sql.SQLContext(sc)\nval hiveContext = new org.apache.spark.sql.hive.HiveContext(sc)\nval employee = sc.textFile(\"employee.txt\")\nemployee.first()\n//val schemaString = \"id name age\"\nimport org.apache.spark.sql.Row;\nimport org.apache.spark.sql.types._;\nval schema = StructType(StructField(\"id\", IntegerType, true) :: StructField(\"name\", StringType, true) :: StructField(\"age\", IntegerType, true) :: Nil)\nval rowRDD = employee.map(_.split(\" \")).map(e \u21d2 Row(e(0).trim.toInt, e(1), e(2).trim.toInt))\nval employeeDF = sqlContext.createDataFrame(rowRDD, schema)\nval finalDF = employeeDF.toDF();\nsqlContext.setConf(\"spark.sql.parquet.compression.codec\", \"snappy\")\nvar WriteParquet= finalDF.write.parquet(\"/user/myname/schemaParquet\")\n</code></pre>\n\n<p>This code should run fine.</p>\n", "tags": ["scala", "hadoop", "apache-spark", "parquet"], "creation_date": 1465365883, "score": 0, "last_activity_date": 1465365883, "answer_id": 37694418, "is_accepted": true, "owner": {"user_id": 5360886, "reputation": 16, "user_type": "registered", "display_name": "Nitin Singh", "link": "http://stackoverflow.com/users/5360886/nitin-singh", "profile_image": "https://www.gravatar.com/avatar/075d291ca7fe1723e6716dd08576fa10?s=128&d=identicon&r=PG&f=1"}, "title": "Not able to create parquet files in hdfs using spark shell", "question_id": 37686601}