{"title": "Problems with PHP variables in the URL of a JavaScript function", "tags": ["javascript", "php"], "creation_date": 1475205353, "score": 1, "body": "<p>I believe you simply need to move your script outside the if loop, yet maintain it in the while loop and you need to add your (shared_id) that is required by the function, to the click event.</p>\n\n<pre><code>&lt;?php\nwhile ($row1 = $sth1-&gt;fetch(PDO::FETCH_ASSOC)){\n    if($_SESSION['scontact_id'] == 'scontact_id' &amp;&amp; $row1['shared_id'] != '' &amp;&amp; $row1['shared_id'] != '0'){\n        echo \"&lt;td&gt; &lt;center&gt;&lt;button onclick='myFunction(\".$row1['shared_id'].\")'&gt;&lt;img border='0' alt='Contacts' src='/Welcome/modules/mod_crmsearch/images/peoplesmall.png'&gt;&lt;/button&gt;&lt;/center&gt;&lt;/td&gt;\";\n    }\necho \"\n    &lt;script&gt;\n    function myFunction(shared_id) {\n        window.open('\". $mywebsite . \"vcontact_id=\" . $row1['shared_id'] .\"' +shared_id, '_blank', 'toolbar=no,scrollbars=yes,resizable=yes,top=200,left=500,width=400,height=400');\n    }\n    &lt;/script&gt;  \n\";\n}\n</code></pre>\n\n<p>If you care at all about page optimization, it would be far wiser instead of looping the script in the while statement, to set a data variable and a class on the button and use an onclick event to determine the values so you don't have 20 instances of the same script with different values on the page. </p>\n\n<p>For example:</p>\n\n<p>Inside your button:</p>\n\n<pre><code>class='clicked' data-id='\".$row1['shared_id'].\"'\n</code></pre>\n\n<p>Then use jquery for the script</p>\n\n<pre><code>&lt;script&gt;\n    $( \".clicked\" ).click(function() {\n        var data = $(this).attr('data-id');\n        window.open('\". $mywebsite . \"vcontact_id='+data', '_blank', 'toolbar=no,scrollbars=yes,resizable=yes,top=200,left=500,width=400,height=400');\n    }\n&lt;/script&gt;\n</code></pre>\n\n<p>This looks for a click event on the class \"clicked\" which we assigned to the button. When button is clicked, we get the value of \"data-id\" and set it as a variable \"data\". We then call that variable instead of echoing a php variable. This allows us to take the script out of the loop and not write it to the page multiple times.</p>\n", "last_activity_date": 1475208423, "answer_id": 39783095, "is_accepted": false, "owner": {"user_id": 597390, "reputation": 397, "user_type": "registered", "accept_rate": 73, "display_name": "Bruce", "link": "http://stackoverflow.com/users/597390/bruce", "profile_image": "https://www.gravatar.com/avatar/70b7c25422d6a8ce865dcf12f7d2be49?s=128&d=identicon&r=PG"}, "last_edit_date": 1475208423, "question_id": 39782901}